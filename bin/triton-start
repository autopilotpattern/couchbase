#!/bin/bash

# Triton-optimized Couchbase Server start script.

set -e

if [ "$1" = 'couchbase-server' ]
then

    if [ "$(id -u)" != "0" ]; then
        echo "This script must be run as root"
        exit 1
    fi

    # Start the bootstrap script and background it
    # the bootstrap will wait for Couchbase to start, then die when done
    /usr/local/bin/triton-bootstrap &

    # Start Couchbase
    /usr/sbin/runsvdir-start "$@"
fi

exec "$@"
